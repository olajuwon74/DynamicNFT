(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"83Sm":function(e,t,a){"use strict";a.r(t),a.d(t,"repair",(function(){return k})),a.d(t,"repairSession",(function(){return E})),a.d(t,"getQueueNotify",(function(){return T})),a.d(t,"upload",(function(){return z}));a("/zsF");var n=a("PArb"),i=(a("7Kak"),a("9yH6")),r=(a("XCrF"),a("1GRj")),l=(a("DZo9"),a("8z0m")),s=a("wt4I"),o=(a("+L6B"),a("2/Rp")),c=(a("miYZ"),a("tsqr")),u=(a("y8nQ"),a("Vl3Y")),p=a("cWIS"),d=a("kLnz"),f=a("b2c1"),h=a("LiBS"),m=a.n(h),g=a("q1tI"),b=a.n(g),y=a("nhC9"),w=a("t23M"),v=a("sy1d"),O=a("z7Xi"),j=a("tCVb"),L=(a("riYV"),a("udzn"));function x(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(a){(e.type.indexOf("image")>-1||e.type.indexOf("video")>-1)&&t(n.result)},n.onerror=function(e){return a(e)}}))}function k(e,t){return S.apply(this,arguments)}function S(){return S=Object(f["a"])(m.a.mark((function e(t,a){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(v["b"])("/api/app/repair/upload/"+t,{method:"POST",data:a,async:!1,success:function(){setState({fileList:[],uploading:!1}),c["default"].success("upload successfully.")},error:function(){setState({uploading:!0}),c["default"].error("upload failed.")}},!0));case 1:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function E(e,t){return F.apply(this,arguments)}function F(){return F=Object(f["a"])(m.a.mark((function e(t,a){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(v["b"])("/api/app/repair/repair/"+t,{method:"POST",data:a,async:!1,success:function(){setState({fileList:[],uploading:!1}),c["default"].success("repair successfully.")},error:function(){setState({uploading:!0}),c["default"].error("repair failed.")}},!0));case 1:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function T(e){return I.apply(this,arguments)}function I(){return I=Object(f["a"])(m.a.mark((function e(t){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(v["b"])("/api/app/repair/repairResult/".concat(t),{method:"GET"},!0));case 1:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function z(e){return V.apply(this,arguments)}function V(){return V=Object(f["a"])(m.a.mark((function e(t){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(v["b"])("/api/app/repair/multipartFile/lively-ref",{method:"POST",data:t},!0));case 1:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}t["default"]=function(e){var t={labelCol:{span:7},wrapperCol:{span:13}},a=Object(g["useState"])(!1),h=Object(d["a"])(a,2),v=(h[0],h[1]),S=Object(g["useState"])({fileList:[],uploading:!1,previewImage:"",previewVideo:""}),F=Object(d["a"])(S,2),I=F[0],z=F[1];e={onRemove:function(e){z((function(t){for(var a=t.fileList.slice(),n=0;n<a.length;n++)e.uid==a[n].uid&&a.splice(n,1);return{fileList:a}}))},beforeUpload:function(e){return z((function(t){return{fileList:[].concat(Object(p["a"])(t.fileList),[e])}})),!1},fileList:ae};var V=u["a"].useForm(),C=Object(d["a"])(V,1),_=C[0],N=e,P=(N.done,N.visible),U=(N.current,N.onDone,N.onCancel,N.onSubmit),M=Object(g["useState"])(),R=Object(d["a"])(M,2),G=R[0],D=R[1],q=Object(g["useState"])(),B=Object(d["a"])(q,2),A=(B[0],B[1],Object(g["useState"])(!1)),H=Object(d["a"])(A,2),J=(H[0],H[1]),Q=Object(g["useState"])(),Y=Object(d["a"])(Q,2),X=Y[0],Z=Y[1],K=Object(g["useState"])(),W=Object(d["a"])(K,2),$=W[0],ee=(W[1],Object(g["useState"])()),te=Object(d["a"])(ee,2),ae=te[0],ne=te[1],ie=Object(g["useState"])(),re=Object(d["a"])(ie,2),le=re[0],se=re[1],oe=Object(g["useState"])(),ce=Object(d["a"])(oe,2),ue=ce[0],pe=ce[1],de=Object(g["useState"])(8),fe=Object(d["a"])(de,2),he=(fe[0],fe[1],Object(g["useState"])()),me=Object(d["a"])(he,2),ge=(me[0],me[1]),be=Object(g["useState"])(),ye=Object(d["a"])(be,2),we=ye[0],ve=ye[1],Oe=Object(g["useState"])(),je=Object(d["a"])(Oe,2),Le=(je[0],je[1],function(){var e=Object(f["a"])(m.a.mark((function e(t){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.type.indexOf("image")>-1)){e.next=9;break}if(t.url||t.preview){e.next=5;break}return e.next=4,x(t.originFileObj);case 4:t.preview=e.sent;case 5:D("image"),se(t.url||t.preview),e.next=19;break;case 9:if(!(t.type.indexOf("video")>-1)){e.next=18;break}if(t.url||t.preview){e.next=14;break}return e.next=13,x(t.originFileObj);case 13:t.preview=e.sent;case 14:D("video"),pe(t.url||t.preview),e.next=19;break;case 18:D("");case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),xe=function(){var e=Object(f["a"])(m.a.mark((function e(t){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.type.indexOf("video")>-1)){e.next=5;break}D("video"),pe(t.url||t.preview),e.next=15;break;case 5:if(!(t.type.indexOf("image")>-1)){e.next=14;break}if(t.url||t.preview){e.next=10;break}return e.next=9,x(t.originFileObj);case 9:t.preview=e.sent;case 10:D("image"),se(t.url||t.preview),e.next=15;break;case 14:D("");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ke=function(e){e.originalIconImg=X,e.effectIconImg=$,U&&U(e)};Object(g["useEffect"])((function(){z({fileList:[]}),c["default"].config({top:180})}),[e.current]);var Se=function(){var e=Object(f["a"])(m.a.mark((function e(t,a){return m.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(_.getFieldsValue("style").style){e.next=3;break}return c["default"].info("please select style..."),e.abrupt("return");case 3:if(ge(""),ve(""),!(t.fileList[t.fileList.length-1].type.indexOf("image")>-1)){e.next=14;break}if(t.fileList[t.fileList.length-1].url||t.fileList[t.fileList.length-1].preview){e.next=10;break}return e.next=9,x(t.fileList[t.fileList.length-1].originFileObj);case 9:t.fileList[t.fileList.length-1].preview=e.sent;case 10:D("image"),se(t.fileList[t.fileList.length-1].url||t.fileList[t.fileList.length-1].preview),e.next=24;break;case 14:if(!(t.fileList[t.fileList.length-1].type.indexOf("video")>-1)){e.next=23;break}if(t.fileList[t.fileList.length-1].url||t.fileList[t.fileList.length-1].preview){e.next=19;break}return e.next=18,x(t.fileList[t.fileList.length-1].originFileObj);case 18:t.fileList[t.fileList.length-1].preview=e.sent;case 19:D("video"),pe(t.fileList[t.fileList.length-1].url||t.fileList[t.fileList.length-1].preview),e.next=24;break;case 23:D("");case 24:if("uploading"!==t.file.status){e.next=27;break}return J(!0),e.abrupt("return");case 27:"done"===t.file.status&&(J(!1),console.log("image info:"+JSON.stringify(t.fileList[0].response.data)),a(t.fileList[0].response.data)),ne(t.fileList),Ee();case 30:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ee=function(){var e=c["default"].loading("create task...",180),t=I.fileList,a=new FormData,n="cartoon";_.getFieldsValue("style").style?(a.append("type",n),a.append("style",_.getFieldsValue("style").style),a.append("file",t[t.length-1]),I.uploading=!0,k(n,a).then((function(t){setTimeout((function(){console.log(t.data),t.data&&t.data.repairId&&(e(),c["default"].success("create task success..."),ge(t.data.repairId),ve(t.data.sessionId))}),1e3)}))):c["default"].info("please select style...")},Fe=function(){if(console.log("current select style:"+_.getFieldsValue("style").style),_.getFieldsValue("style").style)if(we){var e=c["default"].loading("random...",180),t=(I.fileList,new FormData),a="cartoon";t.append("type",a),t.append("sessionId",we),_.getFieldsValue("style").style.indexOf("NFT_houtu")>-1?(t.append("style",_.getFieldsValue("style").style+"_"+Math.floor(48*Math.random())),console.log("current random style:"+t.get("style"))):_.getFieldsValue("style").style.indexOf("NFT_CG4")>-1?(t.append("style",_.getFieldsValue("style").style+"_"+Math.floor(499*Math.random())),console.log("current random style:"+t.get("style"))):_.getFieldsValue("style").style.indexOf("NFT_shouhui")>-1&&(t.append("style",_.getFieldsValue("style").style+"_"+Math.floor(35*Math.random())),console.log("current random style:"+t.get("style"))),I.uploading=!0,E(a,t).then((function(t){setTimeout((function(){var a=this;console.log(t.data),t.data&&t.data.sessionId&&(e(),c["default"].success("random success..."),this.timer=setInterval((function(){T(t.data.sessionId).then((function(e){if(console.log(e.data),e.data&&e.data[e.data.length-1].process){if(-1==e.data[e.data.length-1].process)return c["default"].info("process:"+e.data[e.data.length-1].process+", reason:"+e.data[e.data.length-1].processStr),void clearInterval(a.timer);if(c["default"].info("process:"+(e.data[e.data.length-1].process?e.data[e.data.length-1].process:0)+"%, waiting time:"+(e.data[e.data.length-1].waitTime?e.data[e.data.length-1].waitTime:0)+"seconds..."),100==e.data[e.data.length-1].process&&(clearInterval(a.timer),e.data[e.data.length-1].headUrlList))for(var t=0;t<e.data[e.data.length-1].headUrlList.length;t++){var n=e.data[e.data.length-1].headUrlList[t];if(n.indexOf("local_0_split_out.jpg")>-1){se(n);break}}}}))}),3e3))}),1e3)}))}else c["default"].info("please wait upload Photo/Video...");else c["default"].info("please select style...")};return b.a.createElement(u["a"],Object(s["a"])({},t,{form:_,onFinish:ke}),b.a.createElement(w["a"],{key:"resize-observer",onResize:function(e){v(e.width<596)}},b.a.createElement(y["a"],{split:"horizontal",style:{overflow:"none"}},b.a.createElement(y["a"],{title:"Upload Photo/Video"},b.a.createElement("div",{id:"upload"},b.a.createElement(l["a"],Object(s["a"])({},e,{name:"file",maxCount:1,showUploadList:!1,onChange:function(e){return Se(e,Z)}}),b.a.createElement(o["a"],{icon:b.a.createElement(O["a"],null)},"Single/Multiple Task(s) Upload")),"\xa0","\xa0")),b.a.createElement(y["a"],{split:"vertical"},b.a.createElement(y["a"],{split:"horizontal",colSpan:"88%"},b.a.createElement(y["a"],{split:"horizontal"},b.a.createElement(y["a"],{style:{height:600,align:"center"}},b.a.createElement(y["a"],{title:"",layout:"center"},b.a.createElement("div",null,"image"==G&&b.a.createElement(r["a"],{alt:"",src:le,height:500}),"video"==G&&b.a.createElement(L["Player"],{fluid:!1,height:500,playsInline:!0,src:ue,preload:"auto",autoPlay:!0})),b.a.createElement("div",{style:{pointerEvents:P,opacity:0}},b.a.createElement(l["a"],Object(s["a"])({},e,{fileList:ae,showUploadList:{showRemoveIcon:!1},listType:"picture-card",onPreview:Le,onClick:xe}))))))),b.a.createElement(y["a"],{title:"Choose Style",style:{overflow:"auto"}},b.a.createElement("div",{style:{height:570}},b.a.createElement(u["a"].Item,{name:"style",label:"",initialValue:"NFT_houtu",rules:[{required:!0,message:"please select style"}]},b.a.createElement(i["a"].Group,{defaultValue:"NFT_houtu"},b.a.createElement(i["a"],{value:"NFT_houtu"},"Glowing Beauty"),b.a.createElement(r["a"],{width:110,height:110,src:"https://s3.us-east-2.amazonaws.com/app-s3-us-east-2/upload/OAHwkQkefbDcHZdmHWJKpgxuvGlrzhOz",alt:"NFT_houtu"}),b.a.createElement(n["a"],null),b.a.createElement(i["a"],{value:"NFT_CG4"},"CG Illustration"),b.a.createElement(r["a"],{width:110,height:110,src:"https://s3.us-east-2.amazonaws.com/app-s3-us-east-2/upload/pNUimzdmSRwnzCzNutDbciAbSNPXVkOo",alt:"NFT_CG4"}),b.a.createElement(n["a"],null),b.a.createElement(i["a"],{value:"NFT_shouhui"},"Sketch Beauty"),b.a.createElement(r["a"],{width:110,height:110,src:"https://s3.us-east-2.amazonaws.com/app-s3-us-east-2/upload/MzCSszeuBUrYqxTSsnLMDqjfQxheoTIj",alt:"NFT_shouhui"}))),b.a.createElement(o["a"],{icon:b.a.createElement(j["a"],{twoToneColor:"#eb2f96"}),onClick:Fe},"Random")))))))}}}]);